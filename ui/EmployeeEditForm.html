<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Edit Employee</title>
  <link rel="stylesheet" type="text/css" href="../assets/css/styles.css">
</head>
<body>
  <div class="container">
    <div class="header-bar">Edit Employee</div>

    <form id="editEmployeeForm" onsubmit="handleEditFormSubmit(event)">
      <input type="hidden" id="employeeId">
      <input type="text" id="commonName" placeholder="Common Name" required>
      <select id="jobTitle" required>
        <option value="Associate DVM">Associate DVM</option>
        <option value="Boarding Assistant">Boarding Assistant</option>
      </select>
      <select id="status" required>
        <option value="Onboarding">Onboarding</option>
        <option value="Training">Training</option>
      </select>
      <button type="submit">Save</button>
      <button type="button" onclick="closeForm()">Cancel</button>
    </form>
  </div>

  <script>
    function handleEditFormSubmit(event) {
      event.preventDefault();
      let employee = {
        id: document.getElementById("employeeId").value,
        commonName: document.getElementById("commonName").value,
        jobTitle: document.getElementById("jobTitle").value,
        status: document.getElementById("status").value
      };
      google.script.run.updateEmployee(employee);
      closeForm();
    }

    function closeForm() {
      google.script.run.closeEditForm();
    }
  </script>
</body>
</html>
